{"version":3,"file":"query.js","sourceRoot":"","sources":["../../src/lib/query.ts"],"names":[],"mappings":"AAAA,OAAO,MAAM,MAAM,yBAAyB,CAAC;AAC7C,OAAO,eAAe,CAAC;AAEvB,MAAM,CAAC,KAAK,UAAU,iBAAiB;IACnC,MAAM,GAAG,GAAG;;;;KAIX,CAAC;IAEF,MAAM,EAAC,IAAI,EAAC,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEvC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,WAAW;IAC7B,MAAM,GAAG,GAAG;;;;;;;;;KASX,CAAC;IAEF,MAAM,EAAC,IAAI,EAAC,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEvC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,eAAe,CAAC,GAAa;IAC/C,MAAM,GAAG,GAAG;;;;;;;;;;;;;;;;KAgBX,CAAC;IAEF,MAAM,EAAC,IAAI,EAAC,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEvC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,aAAa,CAAC,IAAY;IAC5C,MAAM,MAAM,CAAC,KAAK,CAAC,2CAA2C,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;AAC5E,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,OAAO,CAAC,KAAa,EAAE,MAAc,EAAE,aAAqB;IAC9E,MAAM,MAAM,CAAC,KAAK,CAAC,qEAAqE,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC;AAC9H,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,WAAW,CAAC,UAAkB,EAAE,SAAiB,EAAE,OAAe,EAAE,UAAyB;IAC/G,MAAM,MAAM,CAAC,KAAK,CAAC,2FAA2F,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC,CAAC;AAClK,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,kBAAkB,CAAC,WAAmB,EAAE,OAAe;IACzE,MAAM,MAAM,CAAC,KAAK,CAAC,gDAAgD,EAAE,CAAC,OAAO,EAAE,WAAW,CAAC,CAAC,CAAC;AACjG,CAAC","sourcesContent":["import client from \"../config/connection.js\";\nimport 'console.table';\n\nexport async function getAllDepartments () {\n    const sql = `\n    SELECT \n    *\n    FROM department;\n    `;\n\n    const {rows} = await client.query(sql);\n\n    return rows;\n}\n\nexport async function getAllRoles() {\n    const sql = `\n    SELECT \n        role.id,\n        role.title,\n        department.name AS department,\n        role.salary\n    FROM role\n    LEFT JOIN department\n        ON role.department_id = department.id\n    `;\n\n    const {rows} = await client.query(sql);\n\n    return rows;\n}\n\nexport async function getAllEmployees(_p0?: boolean) {\n    const sql = `\n    SELECT \n        employee.id as id,\n        employee.first_name,\n        employee.last_name,\n        title,\n        name AS department,\n        salary,\n        CONCAT(manager.first_name, ' ', manager.last_name) AS manager\n    FROM employee\n    JOIN role\n        ON employee.role_id = role.id\n    JOIN department\n        ON role.department_id = department.id\n    LEFT JOIN employee as manager\n        ON employee.manager_id = manager.id\n    `;\n\n    const {rows} = await client.query(sql);\n\n    return rows;\n}\n\nexport async function addDepartment(name: string) {\n    await client.query('INSERT INTO department (name) VALUES ($1)', [name]);\n}\n\nexport async function addRole(title: string, salary: number, department_id: number) {\n    await client.query('INSERT INTO role (title, salary, department_id) VALUES ($1, $2, $3)', [title, salary, department_id]);\n}\n\nexport async function addEmployee(first_name: string, last_name: string, role_id: number, manager_id: number | null) {\n    await client.query('INSERT INTO employee (first_name, last_name, role_id, manager_id) VALUES ($1, $2, $3, $4)', [first_name, last_name, role_id, manager_id]);\n}\n\nexport async function updateEmployeeRole(employee_id: number, role_id: number) {\n    await client.query('UPDATE employee SET role_id = $1 WHERE id = $2', [role_id, employee_id]);\n}"]}